--- glusterfs-3.10.0/configure.ac.orig	2017-02-23 20:08:17.778045369 -0500
+++ glusterfs-3.10.0/configure.ac	2017-03-10 09:43:55.968000000 -0500
@@ -197,6 +197,7 @@
                 extras/init.d/glusterd-Redhat
                 extras/init.d/glusterd-FreeBSD
                 extras/init.d/glusterd-SuSE
+                extras/init.d/glustereventsd-Debian
                 extras/init.d/glustereventsd-Redhat
                 extras/init.d/glustereventsd-FreeBSD
                 extras/ganesha/Makefile
@@ -1054,24 +1055,24 @@
 if test "x$prefix" = xNONE; then
 	prefix=$ac_default_prefix
 fi
-GLUSTERFS_LIBEXECDIR="$(eval echo $prefix)/libexec/glusterfs"
-GLUSTERFSD_MISCDIR="$(eval echo $prefix)/var/lib/misc/glusterfsd"
+GLUSTERFS_LIBEXECDIR="$libexecdir/glusterfs"
+GLUSTERFSD_MISCDIR="$prefix/var/lib/misc/glusterfsd"
 prefix=$old_prefix
 
 ### Dirty hacky stuff to make LOCALSTATEDIR work
 if test "x$prefix" = xNONE; then
-   test $localstatedir = '${prefix}/var' && localstatedir=$ac_default_prefix/var
+   test $localstatedir = '$prefix/var' && localstatedir=$ac_default_prefix/var
    localstatedir=/var
-   LOCALSTATEDIR=$(eval echo ${localstatedir})
+   LOCALSTATEDIR=$localstatedir
 else
-   LOCALSTATEDIR=$(eval echo ${localstatedir})
+   LOCALSTATEDIR=$localstatedir
 fi
 
 old_prefix=$prefix
 if test "x$prefix" = xNONE; then
     prefix=$ac_default_prefix
 fi
-GLUSTERD_VOLFILE="$(eval echo ${sysconfdir})/glusterfs/glusterd.vol"
+GLUSTERD_VOLFILE="$sysconfdir/glusterfs/glusterd.vol"
 prefix=$old_prefix
 
 
--- glusterfs-3.10.0/xlators/mgmt/glusterd/src/Makefile.am.orig	2017-02-23 20:08:17.628045069 -0500
+++ glusterfs-3.10.0/xlators/mgmt/glusterd/src/Makefile.am	2017-03-10 09:40:22.700000000 -0500
@@ -47,7 +47,7 @@
 	-I$(CONTRIBDIR)/rbtree -I$(top_srcdir)/rpc/rpc-lib/src \
 	-I$(CONTRIBDIR)/mount -I$(CONTRIBDIR)/userspace-rcu \
 	-DSBIN_DIR=\"$(sbindir)\" -DDATADIR=\"$(localstatedir)\" \
-	-DGSYNCD_PREFIX=\"$(libexecdir)/glusterfs\" \
+	-DGSYNCD_PREFIX=\"$(GLUSTERFS_LIBEXECDIR)\" \
 	-DCONFDIR=\"$(localstatedir)/run/gluster/shared_storage/nfs-ganesha\" \
 	-DGANESHA_PREFIX=\"$(libexecdir)/ganesha\" \
 	-DSYNCDAEMON_COMPILE=$(SYNCDAEMON_COMPILE) $(XML_CPPFLAGS)
--- glusterfs-3.10.0/events/src/Makefile.am.orig	2017-02-23 20:08:17.502044817 -0500
+++ glusterfs-3.10.0/events/src/Makefile.am	2017-03-10 09:40:00.348000000 -0500
@@ -5,7 +5,7 @@
 BUILT_SOURCES = eventtypes.py
 CLEANFILES = eventtypes.py
 
-eventsdir = $(libexecdir)/glusterfs/events
+eventsdir = $(GLUSTERFS_LIBEXECDIR)/events
 events_PYTHON = __init__.py gf_event.py eventsapiconf.py eventtypes.py \
 	utils.py
 
@@ -13,7 +13,7 @@
 	$(PYTHON) $(top_srcdir)/events/eventskeygen.py PY_HEADER
 
 if BUILD_EVENTS
-eventspeerscriptdir = $(libexecdir)/glusterfs
+eventspeerscriptdir = $(GLUSTERFS_LIBEXECDIR)
 eventsconfdir = $(sysconfdir)/glusterfs
 eventsconf_DATA = eventsconfig.json
 
@@ -24,10 +24,10 @@
 install-exec-hook:
 	$(mkdir_p) $(DESTDIR)$(sbindir)
 	rm -f $(DESTDIR)$(sbindir)/glustereventsd
-	ln -s $(libexecdir)/glusterfs/events/glustereventsd.py \
+	ln -s $(GLUSTERFS_LIBEXECDIR)/events/glustereventsd.py \
 		$(DESTDIR)$(sbindir)/glustereventsd
 	rm -f $(DESTDIR)$(sbindir)/gluster-eventsapi
-	ln -s $(libexecdir)/glusterfs/peer_eventsapi.py \
+	ln -s $(GLUSTERFS_LIBEXECDIR)/peer_eventsapi.py \
 		$(DESTDIR)$(sbindir)/gluster-eventsapi
 
 uninstall-hook:
--- glusterfs-3.10.0/tools/glusterfind/src/Makefile.am.orig	2017-02-23 20:08:17.578044969 -0500
+++ glusterfs-3.10.0/tools/glusterfind/src/Makefile.am	2017-03-10 09:40:00.352000000 -0500
@@ -1,4 +1,4 @@
-glusterfinddir = $(libexecdir)/glusterfs/glusterfind
+glusterfinddir = $(GLUSTERFS_LIBEXECDIR)/glusterfind
 
 glusterfind_PYTHON = conf.py utils.py __init__.py \
 	main.py libgfchangelog.py changelogdata.py
--- glusterfs-3.10.0/tools/glusterfind/Makefile.am.orig	2017-02-23 20:08:17.578044969 -0500
+++ glusterfs-3.10.0/tools/glusterfind/Makefile.am	2017-03-10 09:40:00.352000000 -0500
@@ -6,7 +6,7 @@
 
 CLEANFILES = $(bin_SCRIPTS)
 
-deletehookscriptsdir = $(libexecdir)/glusterfs/glusterfind/
+deletehookscriptsdir = $(GLUSTERFS_LIBEXECDIR)/glusterfind/
 deletehookscripts_SCRIPTS = S57glusterfind-delete-post.py
 
 uninstall-local:
@@ -16,5 +16,5 @@
 	$(mkdir_p) $(DESTDIR)$(GLUSTERD_WORKDIR)/glusterfind/.keys
 	$(mkdir_p) $(DESTDIR)$(GLUSTERD_WORKDIR)/hooks/1/delete/post/
 	rm -f $(DESTDIR)$(GLUSTERD_WORKDIR)/hooks/1/delete/post/S57glusterfind-delete-post
-	ln -s $(libexecdir)/glusterfs/glusterfind/S57glusterfind-delete-post.py \
+	ln -s $(GLUSTERFS_LIBEXECDIR)/glusterfind/S57glusterfind-delete-post.py \
 		$(DESTDIR)$(GLUSTERD_WORKDIR)/hooks/1/delete/post/S57glusterfind-delete-post
--- glusterfs-3.10.0/tools/gfind_missing_files/Makefile.am.orig	2017-02-23 20:08:17.578044969 -0500
+++ glusterfs-3.10.0/tools/gfind_missing_files/Makefile.am	2017-03-10 09:40:00.352000000 -0500
@@ -1,4 +1,4 @@
-gfindmissingfilesdir = $(libexecdir)/glusterfs/gfind_missing_files
+gfindmissingfilesdir = $(GLUSTERFS_LIBEXECDIR)/gfind_missing_files
 
 gfindmissingfiles_SCRIPTS = gfind_missing_files.sh gfid_to_path.sh \
 	gfid_to_path.py
@@ -21,6 +21,6 @@
 
 install-data-local:
 	rm -f $(DESTDIR)$(sbindir)/gfind_missing_files
-	ln -s $(libexecdir)/glusterfs/gfind_missing_files/gfind_missing_files.sh $(DESTDIR)$(sbindir)/gfind_missing_files
+	ln -s $(GLUSTERFS_LIBEXECDIR)/gfind_missing_files/gfind_missing_files.sh $(DESTDIR)$(sbindir)/gfind_missing_files
 
 CLEANFILES =
--- glusterfs-3.10.0/geo-replication/src/Makefile.am.orig	2017-02-23 20:08:17.513044839 -0500
+++ glusterfs-3.10.0/geo-replication/src/Makefile.am	2017-03-10 09:40:00.348000000 -0500
@@ -1,4 +1,4 @@
-gsyncddir = $(libexecdir)/glusterfs
+gsyncddir = $(GLUSTERFS_LIBEXECDIR)
 
 gsyncd_SCRIPTS = gverify.sh peer_gsec_create \
 	set_geo_rep_pem_keys.sh peer_mountbroker peer_mountbroker.py \
@@ -21,7 +21,7 @@
 
 AM_CPPFLAGS = $(GF_CPPFLAGS) -I$(top_srcdir)/libglusterfs/src \
 	-I$(top_srcdir)/rpc/xdr/src -I$(top_builddir)/rpc/xdr/src \
-	-DGSYNCD_PREFIX=\"$(libexecdir)/glusterfs\" -DUSE_LIBGLUSTERFS \
+	-DGSYNCD_PREFIX=\"$(GLUSTERFS_LIBEXECDIR)\" -DUSE_LIBGLUSTERFS \
 	-DSBIN_DIR=\"$(sbindir)\" -DPYTHON=\"$(PYTHON)\"
 
 AM_CFLAGS = -Wall $(GF_CFLAGS)
@@ -35,11 +35,11 @@
 install-exec-hook:
 	$(mkdir_p) $(DESTDIR)$(sbindir)
 	rm -f $(DESTDIR)$(sbindir)/gluster-mountbroker
-	ln -s $(libexecdir)/glusterfs/peer_mountbroker.py \
+	ln -s $(GLUSTERFS_LIBEXECDIR)/peer_mountbroker.py \
 		$(DESTDIR)$(sbindir)/gluster-mountbroker
 
 	rm -f $(DESTDIR)$(sbindir)/gluster-georep-sshkey
-	ln -s $(libexecdir)/glusterfs/peer_georep-sshkey.py \
+	ln -s $(GLUSTERFS_LIBEXECDIR)/peer_georep-sshkey.py \
 		$(DESTDIR)$(sbindir)/gluster-georep-sshkey
 
 
--- glusterfs-3.10.0/geo-replication/syncdaemon/Makefile.am.orig	2017-02-23 20:08:17.514044841 -0500
+++ glusterfs-3.10.0/geo-replication/syncdaemon/Makefile.am	2017-03-10 09:40:00.348000000 -0500
@@ -1,4 +1,4 @@
-syncdaemondir = $(libexecdir)/glusterfs/python/syncdaemon
+syncdaemondir = $(GLUSTERFS_LIBEXECDIR)/python/syncdaemon
 
 syncdaemon_PYTHON = gconf.py gsyncd.py __init__.py master.py README.md repce.py \
 	resource.py configinterface.py syncdutils.py monitor.py libcxattr.py \
--- glusterfs-3.10.0/extras/Makefile.am.orig	2017-02-23 20:08:17.503044819 -0500
+++ glusterfs-3.10.0/extras/Makefile.am	2017-03-10 09:40:00.348000000 -0500
@@ -1,4 +1,4 @@
-addonexecdir = $(libexecdir)/glusterfs
+addonexecdir = $(GLUSTERFS_LIBEXECDIR)
 addonexec_SCRIPTS = peer_add_secret_pub
 
 EditorModedir = $(docdir)
--- glusterfs-3.10.0/cli/src/Makefile.am.orig	2017-02-23 20:08:17.480044773 -0500
+++ glusterfs-3.10.0/cli/src/Makefile.am	2017-03-10 09:40:00.348000000 -0500
@@ -18,7 +18,7 @@
 	-I$(top_builddir)/rpc/xdr/src\
 	-DDATADIR=\"$(localstatedir)\" \
 	-DCONFDIR=\"$(sysconfdir)/glusterfs\" \
-	-DGSYNCD_PREFIX=\"$(libexecdir)/glusterfs\"\
+	-DGSYNCD_PREFIX=\"$(GLUSTERFS_LIBEXECDIR)\"\
 	-DSYNCDAEMON_COMPILE=$(SYNCDAEMON_COMPILE) -DSBIN_DIR=\"$(sbindir)\"\
 	$(XML_CPPFLAGS)
 
--- glusterfs-3.10.0/extras/init.d/Makefile.am.orig	2017-03-10 09:54:15.504000000 -0500
+++ glusterfs-3.10.0/extras/init.d/Makefile.am	2017-03-10 09:54:37.292000000 -0500
@@ -1,7 +1,7 @@
 
 EXTRA_DIST = glusterd-Debian glusterd-FreeBSD glusterd-Redhat glusterd-SuSE \
 	glusterd.plist rhel5-load-fuse.modules \
-	glustereventsd-FreeBSD glustereventsd-Redhat
+	glustereventsd-FreeBSD glustereventsd-Redhat glustereventsd-Debian
 
 CLEANFILES =
 
--- glusterfs-3.10.0/extras/init.d/glustereventsd-Debian.in.orig	2017-02-07 11:44:49.892000000 -0500
+++ glusterfs-3.10.0/extras/init.d/glustereventsd-Debian.in	2017-02-07 11:44:49.892000000 -0500
@@ -0,0 +1,91 @@
+#!/bin/sh
+### BEGIN INIT INFO
+# Provides:          glustereventsd
+# Required-Start:    $local_fs $network
+# Required-Stop:     $local_fs $network
+# Default-Start:     2 3 4 5
+# Default-Stop:      0 1 6
+# Short-Description: Gluster Events Server
+# Description:       Gluster Events Server
+### END INIT INFO
+
+# Author: Chris AtLee <chris@atlee.ca>
+# Patched by: Matthias Albert < matthias@linux4experts.de>
+
+PATH=/sbin:/usr/sbin:/bin:/usr/bin
+NAME=glustereventsd
+SCRIPTNAME=/etc/init.d/$NAME
+DAEMON=@prefix@/sbin/$NAME
+PIDFILE=/var/run/$NAME.pid
+GLUSTEREVENTSD_OPTS=""
+PID=`test -f $PIDFILE && cat $PIDFILE`
+
+
+# Gracefully exit if the package has been removed.
+test -x $DAEMON || exit 0
+
+# Load the VERBOSE setting and other rcS variables
+. /lib/init/vars.sh
+
+# Define LSB log_* functions.
+. /lib/lsb/init-functions
+
+
+do_start()
+{
+    pidofproc -p $PIDFILE $DAEMON >/dev/null
+    status=$?
+    if [ $status -eq 0 ]; then
+      log_success_msg "glustereventsd service is already running with pid $PID"
+    else
+      log_daemon_msg "Starting glustereventsd service" "glustereventsd"
+      start-stop-daemon --start --quiet --oknodo --pidfile $PIDFILE --startas $DAEMON -- -p $PIDFILE $GLUSTEREVENTSD_OPTS
+      log_end_msg $?
+      start_daemon -p $PIDFILE $DAEMON -f $CONFIGFILE
+      return $?
+    fi
+}
+
+do_stop()
+{
+    log_daemon_msg "Stopping glustereventsd service" "glustereventsd"
+    start-stop-daemon --stop --quiet --oknodo --pidfile $PIDFILE
+    log_end_msg $?
+    rm -f $PIDFILE
+    killproc -p $PIDFILE $DAEMON
+    return $?
+}
+
+do_status()
+{
+     pidofproc -p $PIDFILE $DAEMON >/dev/null
+     status=$?
+     if [ $status -eq 0 ]; then
+       log_success_msg "glustereventsd service is running with pid $PID"
+     else
+       log_failure_msg "glustereventsd service is not running."
+     fi
+     exit $status
+}
+
+case "$1" in
+  start)
+        do_start
+        ;;
+  stop)
+        do_stop
+        ;;
+  status)
+        do_status;
+        ;;
+  restart|force-reload)
+        do_stop
+        sleep 2
+        do_start
+        ;;
+  *)
+        echo "Usage: $SCRIPTNAME {start|stop|status|restart|force-reload}" >&2
+        exit 3
+        ;;
+esac
+
